(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1],{2578:function(e,t,l){Promise.resolve().then(l.bind(l,3459))},7168:function(e,t,l){"use strict";var n=l(9099),o=l(9291);let r=(0,n.Ue)()((0,o.tJ)(e=>({board1:[],board2:[],updateBoard1:t=>e({board1:t}),updateBoard2:t=>e({board2:t}),cellColor:[],updateColor:t=>e({cellColor:t})}),{name:"",getStorage:()=>localStorage}));t.Z=r},1781:function(e,t,l){"use strict";var n=l(7437),o=l(2265);t.Z=e=>{let{InputBoard:t,cellColor:l,onBoardUpdate:r=()=>{},mode:a}=e,[s,c]=(0,o.useState)([]),[i,u]=(0,o.useState)(-1),[d,f]=(0,o.useState)(!1),[h,g]=(0,o.useState)(-1),[p,m]=(0,o.useState)([]),[x,b]=(0,o.useState)([]),[v,j]=(0,o.useState)(9);(0,o.useEffect)(()=>{console.log("rerendering");let e=setTimeout(()=>{if(0!==s.length){let e=T();console.log(s,e),r(s),!0===e&&r("solved!")}},100);return()=>clearTimeout(e)},[p]),(0,o.useEffect)(()=>{I()},[p]);let w=()=>{console.log("board setup",x),c(t),m(Array.from({length:t.length+1},()=>[])),b(t),j(t.length)};(0,o.useEffect)(()=>{if(d){let e=setInterval(()=>{M()},200);return()=>{f(!0),clearInterval(e)}}},[]);let S=e=>{console.log("flow setup",x,t),c(e);let l=Array.from({length:e.length+1},()=>[]);for(let t=0;t<e.length;t++)for(let o=0;o<e.length;o++){let r=e[t][o];if(0!==x[t][o]&&0!==r&&l[r].length<=1){l[r]=[];let a=[t*e.length+o];for(;a.length>0;){var n=a.pop();if(void 0===n)break;l[r].push(n);let t=W(Math.floor(n/e.length),n%e.length,e.length,e.length);for(let n=0;n<t.length;n++){let o=t[n][0],s=t[n][1],c=o*e.length+s;e[o][s]!==r||l[r].includes(c)||a.push(c)}}}}m(l)};(0,o.useEffect)(()=>{""===a&&w(),"solution"===a&&S(t),"duel"===a&&(0===x.length&&w(),0!==x.length&&S(t))},[t]);let W=(e,t,l,n)=>{let o=[];for(let[r,a]of[[-1,0],[1,0],[0,-1],[0,1]]){let s=e+r,c=t+a;s>=0&&s<l&&c>=0&&c<n&&o.push([s,c])}return o},N=(e,t)=>{let l=C(s,t),n=p.map(e=>[...e]);if(l){g(t),u(l),f(!0),C(x,t)&&(n[l]=[]);let e=n[l].indexOf(t);-1!==e?n[l]=n[l].slice(0,e+1):n[l].push(t),m(n.map(e=>[...e]))}},k=(e,t)=>{e.preventDefault();let l=p.map(e=>[...e]);if(-1!==h&&-1!==i&&O(t,h,s.length)){if(0!==C(s,t)||_()){if(C(s,t)===i){if(l[i].includes(t)?l[i].splice(l[i].indexOf(t)+1,l[i].length):l[i].push(t),C(x,t)===i){let e=0;for(let t=0;t<l[i].length;t++)C(x,l[i][t])&&(e+=1);if(2===e){m(l.map(e=>[...e]));return}}g(t)}}else l[i].push(t),g(t),y(t)}m(l.map(e=>[...e]))},M=()=>{f(!1)},y=e=>{if(i){let t=s.map(e=>[...e]);t[Math.floor(e/s.length)][e%s.length]=i,c(t.map(e=>[...e]))}},I=()=>{let e=s.map(e=>[...e]),t=new Set(p[i]);for(let l=0;l<s.length;l++)for(let n=0;n<s[l].length;n++){let o=s[l][n],r=l*s.length+n;o!==i||t.has(r)||0!==x[l][n]||(e[l][n]=0)}c(e.map(e=>[...e]))},C=(e,t)=>e[Math.floor(t/s.length)][t%s.length],O=(e,t,l)=>Math.abs(Math.floor(e/l)-Math.floor(t/l))+Math.abs(e%l-t%l)===1,E=(e,t,l)=>{let n=Math.floor(e/l),o=e%l,r=Math.floor(t/l),a=t%l;return n<r?"bottom":n>r?"top":o<a?"right":o>a?"left":""},F=e=>{let{connector:t,val:l}=A(e);if(t)return"connector "+E(e,l,s.length)},A=e=>{let t=p[C(s,e)],l=t.indexOf(e);return{connector:-1!==l&&l!==t.length-1&&t.length>1,val:t[l+1]}},B=e=>{let t=p[C(s,e)],l=t.indexOf(e);return -1!==l&&l===t.length-1&&t.length>1||0!==C(x,e)},D=e=>{let{connector:t,val:n}=A(e),o=C(s,e);return!t||C(x,e)?{background:l[o]}:{}},Z=(e,t)=>{let{connector:n,val:o}=A(t);if(n){let n=E(t,o,s.length);switch(n){case"top":n="Bottom";break;case"bottom":n="Top";break;case"left":n="Right";break;case"right":n="Left"}let r=R(-1);return{backgroundColor:l[e],width:"".concat(r/4,"px"),height:"".concat(r+.25,"px"),["margin".concat(n)]:"".concat(.75*r,"px")}}return{}},R=e=>{let t=.75*Math.min(window.innerHeight,window.innerWidth)/v,l=!1;if(-1!==e){l=0!==C(x,e);let n=C(s,e),o=p[n].indexOf(e),r=o===p[n].length-1&&-1!==o;if(!l&&r)return t/1.75}return l?t/1.5:t},T=()=>{if(0===s.length)return!1;for(let e=0;e<v;e++)for(let t=0;t<v;t++)if(0===s[e][t])return!1;let e=p.map(e=>[...e]);for(let t of(e.shift(),e)){let e=0;for(let l of t)C(x,l)&&(e+=1);if(e<2)return!1}return!0},_=()=>{let e=0;for(let t of p[i])C(x,t)&&(e+=1);return 2===e};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"text-center p-5 m-5",children:(0,n.jsx)("div",{className:"board grid",style:{gridTemplateColumns:"repeat(".concat(v,", 1fr)"),gridTemplateRows:"repeat(".concat(v,", 1fr)")},children:s.flat().map((e,t)=>(0,n.jsx)(o.Fragment,{children:(0,n.jsxs)("div",{style:{width:"".concat(R(-1),"px"),height:"".concat(R(-1),"px")},className:"boardCell flex justify-center items-center",children:[A(t)&&(0,n.jsx)("div",{draggable:!0,className:"".concat(F(t)),style:Z(e,t)}),(0,n.jsx)("button",{draggable:!0,onDragStart:e=>N(e,t),onDragOver:e=>k(e,t),onDrop:M,style:{...D(t),width:"".concat(R(t),"px"),height:"".concat(R(t),"px")},className:"flex justify-center item-center \n          ".concat(B(t)?"circle":""),children:B(t)?e:""})]})},t))})})})}},3459:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return x}});var n=l(7437),o=l(2265),r=l(1781),a=l(6463),s=e=>{let{isActive:t}=e,[l,r]=(0,o.useState)(0),a=(0,o.useRef)(null);return(0,o.useEffect)(()=>{a.current=Date.now()-l;let e=null;return t&&(e=setInterval(()=>{null!==a.current&&r(Date.now()-a.current)},1e3/60)),()=>{e&&clearInterval(e)}},[t]),(0,n.jsx)("h4",{children:(e=>{let t="0".concat(e%1e3).slice(-3),l=Math.floor(e/1e3),n="0".concat(l%60).slice(-2),o="0".concat(Math.floor(l/60)%60).slice(-2);return"".concat(o,":").concat(n,".").concat(t)})(l)})},c=l(9013),i=l(2400),u=l(3714),d=l(5256),f=l(1887),h=l(7971),g=l(8035),p=l(7168),m=l(5145),x=()=>{let[e,t]=(0,o.useState)((0,p.Z)(e=>e.board1)),[l,x]=(0,o.useState)((0,p.Z)(e=>e.board2)),b=(0,a.usePathname)(),[v,j]=(0,o.useState)((0,p.Z)(e=>e.cellColor));(0,a.usePathname)();let{isOpen:w,onOpen:S,onOpenChange:W}=(0,c.q)(),[N,k]=(0,o.useState)(""),M=(0,a.useRouter)(),y=(0,p.Z)(e=>e.updateBoard1),I=(0,p.Z)(e=>e.updateBoard2),[C,O]=(0,o.useState)(""),[E,F]=(0,o.useState)(!1),[A,B]=(0,o.useState)("N/A");return(0,o.useEffect)(()=>{let e=localStorage.getItem("userId");e||(e=(1e3*Math.random()).toString(),localStorage.setItem("userId",e)),console.log("user Id is",e),O(e)},[]),(0,o.useEffect)(()=>{function e(){F(!0),B(m.W.io.engine.transport.name),m.W.io.engine.on("upgrade",e=>{B(e.name)})}function t(){F(!1),B("N/A")}""!==C&&m.W.emit("userID",C,m.W.id),m.W.connected&&(e(),console.log("emitting playerID"),m.W.emit("playerID",b,C));let l=e=>{"you won"===e?k("1"):k("2"),S()},n=e=>{console.log("response from op move",e),x(e),I(e)};return m.W.on("connect",e),m.W.on("disconnect",t),m.W.on("opponentMove",n),m.W.on("endGame",e=>l(e)),()=>{m.W.off("connect",e),m.W.off("disconnect",t),m.W.off("opponentMove",n),m.W.off("endGame")}},[C]),(0,n.jsx)(n.Fragment,{children:""!==b?(0,n.jsxs)("div",{className:"h-full",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{children:["Status: ",E?"connected":"disconnected"]}),(0,n.jsxs)("p",{children:["Transport: ",A]})]}),(0,n.jsx)("div",{className:"text-center flex",children:(0,n.jsx)(s,{isActive:""===N})}),""!==N?(0,n.jsx)(i.R,{backdrop:"opaque",classNames:{body:"py-6",backdrop:"bg-[#000000]/50 backdrop-opacity-40",base:"border-[#000000] bg-[#000000] dark:bg-[#000000] text-[#FFFFFF]",header:"border-b-[1px] border-[#000000]",footer:"border-t-[1px] border-[#000000]",closeButton:"hover:bg-white/5 active:bg-white/10"},isOpen:w,onOpenChange:W,children:(0,n.jsx)(u.A,{children:e=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.k,{className:"flex flex-col gap-1",children:"Game Over"}),(0,n.jsx)(f.I,{children:"1"===N?"You won!":"You lost"}),(0,n.jsxs)(h.R,{className:"w-full",children:[(0,n.jsx)(g.A,{color:"danger",variant:"light",onPress:e,children:"Close"}),(0,n.jsx)(g.A,{onClick:()=>M.push("/duel/"),children:"Play Again"})]})]})})}):(0,n.jsx)("div",{}),(0,n.jsxs)("div",{className:"flex flex-lg-row flex-col lg:flex-row m-4 text-center",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("h3",{children:"You"}),(0,n.jsx)(r.Z,{InputBoard:e,cellColor:v,onBoardUpdate:l=>{if(console.log("reaching updateMove",l),"solved!"===l)console.log("emitted won"),m.W.emit("gameWon",C);else{let n=!1;for(let t=0;t<l.length;t++)for(let o=0;o<l.length;o++)if(e[t][o]!==l[t][o]){n=!0;break}n&&(t(l),y(l),console.log("op move",l),m.W.emit("updateMove",l,C))}},mode:"duel"},1)]}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("h3",{children:"Opponent"}),(0,n.jsx)(r.Z,{InputBoard:l,cellColor:v,mode:"duel"},2)]})]})]}):"joined : ".concat(b)})}},5145:function(e,t,l){"use strict";l.d(t,{W:function(){return n}});let n=(0,l(4999).io)("https://flowfreeserver.onrender.com")}},function(e){e.O(0,[870,374,734,971,23,744],function(){return e(e.s=2578)}),_N_E=e.O()}]);